# 项目解析：undoom-douyin-data-analysis

## 1. 项目概述

`undoom-douyin-data-analysis` 是一个基于 MCP (Model-Centric Programming) 架构的抖音数据分析工具。它提供了一个服务端点，用于采集、分析和导出抖音的视频及用户数据。

该项目利用 `DrissionPage` 进行网页自动化操作，实现动态加载内容的抓取，并通过 `BeautifulSoup` 解析 HTML，提取关键信息。数据分析功能则借助 `pandas` 和 `jieba` 实现，能够进行互动数据分析、内容长度分析和关键词提取。

## 2. 项目结构

```
/
├── .codebuddy/
├── .gitignore
├── .python-version
├── LICENSE
├── README.md
├── mcp_config.json
├── pyproject.toml
├── undoom_douyin_data_analysis/
│   ├── __init__.py
│   └── douyin_mcp_server.py
└── uv.lock
```

- **`pyproject.toml`**: 定义了项目的元数据和依赖项，是项目的核心配置文件。
- **`undoom_douyin_data_analysis/douyin_mcp_server.py`**: 项目的核心逻辑所在，实现了 MCP 服务器的全部功能。
- **`uv.lock`**: 锁定了项目的依赖版本，确保环境的一致性。

## 3. 核心依赖

项目的主要依赖项在 `pyproject.toml` 中定义：

- **`mcp[cli]>=1.12.4`**: MCP 框架，用于构建和运行 MCP 服务器。
- **`DrissionPage>=4.0.0`**: 强大的网页自动化工具，用于模拟浏览器行为和抓取动态内容。
- **`beautifulsoup4>=4.12.0`**: 用于解析 HTML 和 XML 文档，提取所需数据。
- **`pandas>=2.0.0`**: 提供高性能、易于使用的数据结构和数据分析工具。
- **`jieba>=0.42.1`**: 中文分词库，用于从标题中提取关键词。
- **`openpyxl>=3.1.0`**: 用于读写 Excel 2010 xlsx/xlsm/xltx/xltm 文件。
- **`lxml>=4.9.0`**: 高性能的 HTML/XML 解析库。
- **`requests>=2.31.0`**: 简洁而强大的 HTTP 请求库。

## 4. 核心功能

`douyin_mcp_server.py` 中实现的 `DouyinMCPServer` 类是项目的核心，提供了以下主要功能：

### 4.1. 数据采集

- **`search_douyin_videos`**: 根据关键词搜索抖音视频，通过滚动页面来加载更多结果，并提取视频信息。
- **`search_douyin_users`**: 根据关键词搜索抖音用户，同样通过滚动加载来获取用户列表。

### 4.2. 数据分析

- **`analyze_interaction_data`**: 分析已采集视频的互动数据，如点赞数，并生成统计报告。
- **`analyze_content_length`**: 分析视频标题的长度分布，帮助理解内容的呈现方式。
- **`analyze_keywords`**: 使用 `jieba` 对视频标题进行分词，并统计高频词汇。

### 4.3. 数据管理

- **`export_data`**: 将采集到的数据导出为 `json`、`excel` 或 `csv` 格式。
- **`get_data_summary`**: 提供当前已采集数据的摘要信息。
- **`clear_data`**: 清空已采集的数据。

## 5. 工作流程

1. **初始化**: `DouyinMCPServer` 启动时，会设置好所有的工具和资源处理器。
2. **调用工具**: 客户端（如 MCP 客户端）可以调用 `search_douyin_videos` 或 `search_douyin_users` 等工具来采集数据。
3. **数据抓取**: 服务器使用 `DrissionPage` 打开抖音搜索页面，并通过模拟滚动来加载动态内容。
4. **数据解析**: 使用 `BeautifulSoup` 解析页面 HTML，提取视频或用户数据。
5. **数据存储**: 采集到的数据存储在 `collected_data` 字典中。
6. **数据分析**: 客户端可以调用分析工具，服务器会使用 `pandas` 和 `jieba` 对已存储的数据进行分析，并返回分析报告。
7. **数据导出**: 用户可以随时将采集和分析的结果导出到本地文件。

## 6. 如何运行

项目通过 `pyproject.toml` 中的 `[project.scripts]` 定义了一个命令行入口点 `undoom-douyin-mcp`。可以通过以下方式运行服务器：

```bash
undoom-douyin-mcp
```

服务器启动后，将通过标准输入/输出与 MCP 客户端进行通信。

## 7. 总结

`undoom-douyin-data-analysis` 是一个功能完善的数据分析工具，它将网页抓取、数据处理和 MCP 服务端架构有机结合，为抖音数据分析提供了一个高效、可扩展的解决方案。

